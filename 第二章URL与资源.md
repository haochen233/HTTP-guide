URI是一类更通用的资源标识符，URL 实际上是它的一个子集。URI 是一个通用的概念，由两个主要的子集 URL 和 URN 构成，URL 是通过描述资源的位置来标识资源的，而 URN则是通过名字来识别资源的，与它们当前所处位置无关。

>HTTP 规范将更通用的概念 URI 作为其资源标识符，但实际上，HTTP 应用程序处理的只是 URI 的 URL 子集。但是我们所说的基本上都是 URL。

URL分为三部分：  
- 第一部分是URL方案（Schema），告知Web客户端怎样访问资源
- URL的的第二部分指的是服务器的位置
- 第三部分时资源路径。路径说明了请求的是服务器上哪个特定的本地资源

URL提供了一种统一的资源命名方式，大多数URL都有同样的`方案://服务器位置/路径`结构。

## URL出现前的黑暗岁月
>有了Web浏览器，就不再需要用新闻阅读器来阅读因特网新闻，或者用FTP客户端来访问FTP服务器上的文件了，而且也无需用电子邮件程序来收发email了。  URL告知浏览器如何对资源进行访问和处理这有助于简化复杂的网络世界。应用程序可以使用 URL 来简化信息的访问过程。

# 2.2 URL的语法
URL 提供了一种定位因特网上任意资源的手段，但这些资源是可以通过各种不同的方案（比如 HTTP、FTP、SMTP）来访问的，因此 URL 语法会随方案的不同而有所不同。


大多数URL 方案的 URL 语法都建立在这个由 9 部分构成的通用格式上：  
`<scheme>://<user>:<password>@<host>:<port>/<path>;<params>?<query>#<frag> `

> 几乎没有哪个URL中包含了所有这些组件。URL最重要的3个部分是方案（scheme） 、主机（host）和路径（path）。


## 通用URL组件
| 组件 | 描述 | 默认值 |
| --- | --- | --- |
| 方案(scheme) | 访问服务器以获取资源时要使用哪种协议 | 无 | 
| 用户（user） | 某些方案访问资源时需要的用户名 | 匿名 |
| 密码（password） | 用户名后面可能要包含的密码，中间由冒号（:）分隔| <E-mail 地址> |
| 主机（host） | 资源宿主服务器的主机名或IP地址 | 无 | 
| 端口（port） | 资源宿主服务器正在监听的端口号。很多方案都有默认端口号（HTTP 的默认端口号为 80） | 每个方案特有（例如HTTP默认是80端口） |
| 路径（path） | 服务器上资源的本地名，由一个斜杠（/）将其与前面的URL组件分隔开来。路径路径组件的语法是与服务器和方案有关的。 | 无 | 
| 参数（params） | 某些方案会用这个组件来指定输入参数。参数为名 / 值对。URL 中可以包含多个参数字段，它们相互之间以及与路径的其余部分之间用分号（;）分隔 | 无 | 
| 查询（query） | 某些方案会用这个组件传递参数以激活应用程序 | 查询组件的内容没有通用格式。用字符“?”将其与 URL 的其余部分分隔开来 | 无 |
| 片段（frags） | 一小片或一部分资源的名字。引用对象时，不会将frag字段传送给服务器；这个字段是在客户端内部使用的。通过字符“#”将其与 URL 的其余部分分隔开来 | 无 |
---

## 2.2.1 方案————使用什么协议
方案组件必须以一个字母符号开始，由第一个“:”符号将其与 URL 的其余部分分隔开来。方案名是大小写无关的，

> 例如： "http://www.baidu.com"和"HTTP://www.baidu.com"是等价的

## 2.2.2 主机与端口
略

## 2.2.3 用户名和密码
更有趣的组件是用户和密码组件。很多服务器都要求输入用户名和密码才会允许用户访问数据。

例如：`http://joe:joespasswd@www.joes-hardware.com/sales_info.txt`

## 2.2.4 路径
URL 的路径组件说明了资源位于服务器的什么地方。路径通常很像一个分级的文件系统路径。比如：  
`http://www.joes-hardware.com:80/seasonal/index-fall.html`  
这个 URL 中的路径为 /seasonal/index-fall.html，很像 UNIX 文件系统中的文件系统路径。

> 路径是服务器定位资源时所需的信息。可以用字符“/”将 HTTP URL 的路径组件划分成一些路径段（path  segment） （还是与 UNIX 文件系统中的文件路径类似）。每个路径段都有自己的参数（param）组件。

## 2.2.5 参数
对很多方案来说，只有简单的主机名和到达对象的路径是不够的。除了服务器正在监听的端口，以及是否能够通过用户名和密码访问资源外，很多协议都还需要更多的信息才能工作。

为了向应用程序提供它们所需的输入参数，以便正确地与服务器进行交互，URL 中有一个参数组件。这个组件就是 URL 中的名值对列表，由字符“;”将其与 URL 的其余部分（以及各名值对）分隔开来。它们为应用程序提供了访问资源所需的所有附加信息。比如：  
`ftp://prep.ai.mit.edu/pub/gnu;type=d`在这个例子中，有一个参数type=d，参数名为type，值为d。  

如前所述，HTTP URL 的路径组件可以分成若干路径段。每段都可以有自己的参数。比如：  
`http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true`。这个例子有两个路径段，，hammers 和 index.html。hammers 路径段有参数 sale，其值为 false。index.html 段有参数 graphics，其值为 true。

## 2.2.6 查询字符串
很多资源，比如数据库服务，都是可以通过提问题或进行查询来缩小所请求资源类型范围的。

假设 Joe 的五金商店在数据库中维护着一个未售货物的清单，并可以对清单进行查询，以判断产品是否有货，那就可以用下列 URL 来**查询 Web 数据库网关**，看看编号为 **12731** 的条目是否有货：  

`http://www.joes-hardware.com/inventory-check.cgi?item=12731`  

问号右边的部分被称为查询组件。URL的查询组件和表示网关资源的URL路径组件一起被发送给网关资源。

>基本上可以将网关当做访问其他应用程序的访问点。  

按照常规，很多网关都希望查询字符串以一系列“名 / 值”对的形式出现，名值对之间用字符“&”分隔，例如：  

` http://www.joes-hardware.com/inventory-check.cgi?item=12731&color=blue`

在这个例子中，查询组件有两个键值对: item=12731和color=blue。目的查询清单中是否有颜色为蓝色的条目12731。

## 2.2.7 片段
有些资源类型，比如 HTML，除了资源级之外，还可以做进一步的划分。比如，对一个带有章节的大型文本文档来说，资源的 URL 会指向整个文本文档，但理想的情况是，能够指定资源中的那些章节。

为了引用部分资源或资源的一个片段，URL 支持使用片段（frag）组件来表示一个资源内部的片段。比如，URL 可以指向 HTML 文档中一个特定的图片或小节。

片段挂在URL的右手边，最前面有一个字符“#”。比如：  

`http://www.joes-hardware.com/tools.html#drills`

在这个例子中，片段drills引用了Joe的五金商店Web服务器上页面/tools.html中的一个部分。这部分的名字叫做 drills。

>服务器处理的是整个对象，因此URL片段仅由客户端使用。

# 2.3 URL快捷方式

## 2.3.1 相对URL
URL有两种方式：绝对的和相对的。到目前为止，我们只见过绝对 URL。绝对URL 中包含有访问资源所需的全部信息。

另一方面，相对 URL 是不完整的。要从相对 URL 中获取访问资源所需的全部信息，就必须相对于另一个，被称为其基础（base）的 URL 进行解析。

例如在访问资源`http://www.joes-hardware.com/tools.html`时，该html中包含了URL `./hammers.html`的超链接。实际上这是一个合法的相对URL。可以相对于它所在文档的URL对其进行解释；基础URL为`http://www.joes-hardware.com/tools.html`,用这个URl做基础可以推导出缺失的信息。我们可以推导出方案为`http`，主机为`www.joes-hardware.com`。则新的URL是`http://www.joes-hardware.com/hammers.html`

需要注意的是相对URL为保持一组资源（比如一些 HTML 页面）的可移植性提供了一种便捷方式。如果使用的是相对 URL，就可以在搬移一组文档的同时，仍
然保持链接的有效性，因为相对 URL 都是相对于新基础进行解释的。这样就可以实现在其他服务器上提供镜像内容之类的功能了。（例如，主机名发生变化，相对URL依旧有）

## 2.3.2 自动扩展URL
有些浏览器会在用户提交 URL 之后，或者在用户输入的时候尝试着自动扩展 URL。这就为用户提供了一条捷径：用户不需要输入完整的 URL，因为浏览器会自动 扩展。

这些“自动扩展”特性有以下两种方式：  

- 主机名扩展  
在主机名扩展中，只要有些小提示，浏览器通常就可以在没有帮助的情况下，将你输入的主机名扩展为完整的主机名。例如：在地址栏输入`baidu`，浏览器就会自动在主机名中插入 `www.`
和 `.com`

- 历史扩展  
浏览器用来节省用户输入 URL 时间的另一种技巧是，将以前用户访问过的 URL历史存储起来。当你输入 URL 时，它们就可以将你输入的 URL 与历史记录中URL 的前缀进行匹配，并提供一些完整的选项供你选择。（chrome中有）

# 2.4 各种令人头疼的字符

## 2.4.1 URL字符集
从历史上来看，很多计算机应用程序使用的都是 US-ASCII 字符集（也就是平时所说的ASCII字符集）。其可移植性非常好。

> 虽然ASCII的值在0~255之间，但是标准的是0~127之间的字符，128~255之间为IBM-PC上专用的，所以标准ASCII码是7比特位。

## 2.4.2 编码机制
了避开安全字符集表示法带来的限制，人们设计了一种编码机制，用来在 URL 中表示各种不安全的字符。这种编码机制就是通过一种“转义”表示法来表示不安全字符的，这种转义表示法包含一个百分号（%），后面跟着两个表示字符 ASCII 码的十六进制数。

举几个示例：  
| 字符 | ASCII码 | 示例URL |
| --- | --- | --- |
| ~ | 126(0x7E) | http://www.joes-hardware.com/%7Ejoe | 
| 空格 | 32(0x20) | http://www.joes-hardware.com/more%20tools.html | 
| % | 37(0x25) | http://www.joes-hardware.com/100%25satisfaction.html |

---

## 2.4.3 字符限制
在 URL 中，有几个字符被保留起来，有着特殊的含义。有些字符不在定义的 US-ASCII 可打印字符集中。还有些字符会与某些因特网网关和协议产生混淆，因此不赞成使用。

> 就类似，Linux星号（*）会被bash shell 识别为通配符，如果需要使用星号需要加上反斜杠转义。

下面列出URL中有特殊作用的字符：  
| 字符 | 保留/受限 | 
| --- | --- | 
| % | 保留作为编码字符的转义标志 | 
| / | 保留作为路径组件中分隔路径段的定界符 | 
| . | 保留在路径组件中使用 | 
| .. | 保留在路径组件中使用 | 
| # | 保留作为分段定界符(片段)使用 | 
| ? | 保留作为查询字符串定界符使用 | 
| ; | 保留作为参数定界符使用 | 
| : | 保留作为方案、用户 / 口令，以及主机 / 端口组件的定界符使用 | 
| $,+ | 保留 |
| @ & = | 在某些方案的上下文中有特殊的含义，保留 |
| { } | \ ^ ~ [ ] ' | 由于各种传输 Agent 代理，比如各种网关的不安全处理，使用受限 | 
| <> " | 不安全；这些字符在 URL 范围之外通常是有意义的，比如在文档中对 URL 自身
进行定界（比如 http://www.joes-hardware.com） ，所以应该对其进行编码 | 
| 0x00-0x1F,0x7F | 受限，这些十六进制范围内的字符都在 US-ASCII 字符集的不可打印区间内(打印这些，屏幕上看不到) | 
| >0x7F | 受限，十六进制值在此范围内的字符都不在 US-ASCII 字符集的 7 比特范围内(即大于127了) | 

## 2.4.4 另外一点说明
你可能会感到奇怪，为什么使用一些不安全字符的时候并没有发生什么不好的事情。你可以访问 http://www.joes-hardware.com/~joe 上的 Joe 主页，而无需对“~”字符进行编码。对某些传输协议来说，这并不是什么问题，但对应用程序开发人员来说，对非安全字符进行编码仍然是明智的。

应用程序要按照一定规范工作。客户端应用程序在向其他应用程序发送任意 URL 之前，最好把所有不安全或受限字符都进行转换 6。只要对所有不安全字符都进行了编码，这个 URL 就是可在各应用程序之间共享的规范形式；也就无需操心其他应用程序会被字符的任何特殊含义所迷惑了。

> 最好把所有不安全字符或受限字符进行编码，这个URL的就不会出什么幺蛾子。

